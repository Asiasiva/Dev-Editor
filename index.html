<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live HTML Editor</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the editor look and feel */
        :root {
            --editor-bg: #1e1e1e;
            --editor-fg: #d4d4d4;
        }

        /* Using Inter font as required */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        /* Container for the 50/50 split (Editor and Output) */
        .main-split {
            display: flex;
            flex-direction: column; /* Stack vertically on small screens */
            height: 100%;
            gap: 1rem;
        }

        /* Large screen: split into two columns */
        @media (min-width: 1024px) {
            .main-split {
                flex-direction: row;
            }
        }

        .code-input {
            width: 100%;
            height: 100%;
            padding: 1rem;
            border: none;
            resize: none;
            font-family: monospace;
            font-size: 0.875rem;
            line-height: 1.4;
            outline: none;
            background-color: var(--editor-bg);
            color: var(--editor-fg);
        }

        /* Output frame styling */
        #output-frame {
            border: none; /* Border handled by container in normal mode */
            background-color: white;
            width: 100%;
            height: 100%;
        }

        /* Full-Screen Mode Styles */
        .fullscreen-mode {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999; /* Ensure it covers everything */
            padding: 1rem;
            background-color: white; 
            margin: 0 !important; /* Override margins from Tailwind classes */
            border-radius: 0 !important;
        }

        .hidden-editor {
            display: none !important;
        }
    </style>
</head>
<body class="h-screen flex flex-col p-4 md:p-6 bg-gray-100">

    <!-- Header and Global Controls -->
    <div class="flex-none bg-white p-3 rounded-xl shadow-lg mb-4 flex justify-between items-center">
        <h1 class="text-xl font-extrabold text-blue-700">Live HTML Editor</h1>
        <div class="flex space-x-3">
            <button onclick="downloadCode();" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium rounded-lg shadow-md transition duration-150">
                Download HTML
            </button>
            <button onclick="clearCode();" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg shadow-md transition duration-150">
                Clear Code & Reset
            </button>
        </div>
    </div>

    <!-- Main Split Area: HTML Editor and Live Output -->
    <div class="main-split flex-1 min-h-0">
        
        <!-- 1. HTML Editor Panel (Target for hiding in fullscreen) -->
        <div class="html-editor-panel flex-1 flex flex-col rounded-xl overflow-hidden shadow-2xl">
            <label for="html-code" class="bg-blue-600 text-white font-bold p-3 text-lg">HTML Source</label>
            <textarea id="html-code" class="code-input flex-1"></textarea>
        </div>

        <!-- 2. Live Output Panel (Target for fullscreen mode) -->
        <div class="output-panel-container flex-1 flex flex-col rounded-xl overflow-hidden shadow-2xl">
            <div class="flex justify-between items-center bg-gray-700 text-white p-3">
                <label class="font-bold text-lg">Live Output</label>
                <button id="fullscreen-btn" onclick="toggleFullscreen();" class="px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white text-xs font-medium rounded-lg shadow-md transition duration-150">
                    Full Screen Output
                </button>
            </div>
            <iframe id="output-frame" class="flex-1"></iframe>
        </div>

    </div>

    <script>
        // References to the DOM elements
        const htmlCode = document.getElementById('html-code');
        const outputFrame = document.getElementById('output-frame');
        
        // New elements for the fullscreen feature
        const editorPanel = document.querySelector('.html-editor-panel');
        const outputPanel = document.querySelector('.output-panel-container');
        const fullscreenButton = document.getElementById('fullscreen-btn');

        // Debounce setup for performance optimization
        let debounceTimer;
        const DEBOUNCE_DELAY = 300; // Wait 300ms after last input before running code

        /**
         * Toggles the full-screen view for the output panel.
         */
        function toggleFullscreen() {
            const isFullscreen = outputPanel.classList.toggle('fullscreen-mode');
            editorPanel.classList.toggle('hidden-editor');

            // Update button text and styling
            if (isFullscreen) {
                fullscreenButton.innerHTML = 'Exit Full Screen';
                // Replace classes for color change
                fullscreenButton.classList.replace('bg-gray-500', 'bg-red-500');
                fullscreenButton.classList.replace('hover:bg-gray-600', 'hover:bg-red-600');
            } else {
                fullscreenButton.innerHTML = 'Full Screen Output';
                // Replace classes for color change
                fullscreenButton.classList.replace('bg-red-500', 'bg-gray-500');
                fullscreenButton.classList.replace('hover:bg-red-600', 'hover:bg-gray-600');
            }
        }

        /**
         * 1. Takes the HTML content.
         * 2. Writes the result to the iframe for live preview.
         */
        function updateOutput() {
            const html = htmlCode.value;

            // Simple HTML document wrapper for the input
            const finalOutput = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Live Preview</title>
                </head>
                <body>
                    ${html}
                </body>
                </html>
            `;

            // Use the contentWindow to write the new document
            outputFrame.contentWindow.document.open();
            outputFrame.contentWindow.document.write(finalOutput);
            outputFrame.contentWindow.document.close();
        }

        /**
         * 2. Saves the current editor content to the browser's local storage.
         */
        function saveCode() {
            try {
                localStorage.setItem('liveEditor_html_only', htmlCode.value);
            } catch (e) {
                console.warn("Could not save to localStorage:", e);
            }
        }

        /**
         * 3. Executes updateOutput and saveCode after a delay, resetting the timer on every input.
         */
        function debouncedUpdate() {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                updateOutput();
                saveCode();
            }, DEBOUNCE_DELAY);
        }
        
        /**
         * 6. Creates a file from the HTML content and triggers a download.
         */
        function downloadCode() {
            const htmlContent = htmlCode.value;
            const filename = 'my_live_code.html';
            
            // Create a Blob with the content and set the MIME type
            const blob = new Blob([htmlContent], { type: 'text/html' });
            
            // Create a temporary link element
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = filename; // Set the desired file name
            
            // Append the link to the body, click it to trigger download, and remove it
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            // Clean up the object URL
            URL.revokeObjectURL(a.href);
        }


        /**
         * 4. Loads saved content from local storage upon initialization.
         */
        function loadCode() {
            try {
                // Initialize with saved data or a basic boilerplate if no data is found
                htmlCode.value = localStorage.getItem('liveEditor_html_only') || '<h1>Welcome to the HTML Editor!</h1>\n<p>Type your HTML code here to see the live preview.</p>';
            } catch (e) {
                console.warn("Could not load from localStorage:", e);
            }
        }

        /**
         * 5. Clears the editor and local storage.
         */
        function clearCode() {
            // Ensure fullscreen mode is off when clearing/resetting
            if (outputPanel.classList.contains('fullscreen-mode')) {
                toggleFullscreen();
            }

            htmlCode.value = '';
            localStorage.removeItem('liveEditor_html_only');
            updateOutput(); // Update output to clear the preview
        }

        // Initialize the application on load
        window.onload = () => {
            loadCode();
            updateOutput();

            // Attach the debounced handler to the input event
            htmlCode.addEventListener('input', debouncedUpdate);
        };
    </script>
</body>
</html>


